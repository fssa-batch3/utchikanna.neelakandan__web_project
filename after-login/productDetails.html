<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD"
      crossorigin="anonymous"
    /> -->
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="../assets/images/Cinephile.png"
    />
   
    <title>Hollywood</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <link rel="stylesheet" type="text/css" href="../assets/css/movie.css" />
    <link
      rel="stylesheet"
      type="text/css"
      href="../after-login/assets/css/movie.css"
    />

    <link rel="stylesheet" href="../after-login/assets/css/comment.css" />

    <title>Document</title>
  </head>
  <body>
    <h2 class="up" id="movie_title"></h2>
    <div>
      <iframe
        width="600"
        height="400"
        id="trailer"
        title="YouTube video player"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
        allowfullscreen
        src="https://youtu.be/W2u81k7hKl8"
      ></iframe>
      <div class="left">
        <hr />
        <h2><b>Rating:</b> <span id="rateOfTheMovie"></span></h2>
        <hr />
        <h2>About the Movie</h2>
        <p id="contentOfMovie">
          <!-- When a storm upturns their yacht, a group of passengers jump on board
          <br />a ship close by. However, they soon realise that they are<br />
          in greater danger aboard the mysterious vessel. -->
        </p>
        <hr />
        <p><b>Release date:</b><span id="releaseDate"></span></p>
        <hr />
        <p>
          <b>Director:</b
          ><a id="directorLink"><span id="directorName"></span></a>
        </p>
        <hr />
        <p>
          <b>Cinematography:</b
          ><a id="mDirectorLink"><span id="mDirectorName"></span></a>
        </p>
        <hr />
      </div>
    </div>
    <h2 class="cast">
      Top cast
      <img
        alt="image"
        class="angle"
        src="../assets/images/angle-small-right.png"
      />
    </h2>
    <div class="top">
      <div class="img-actor">
        <a class="ang" id="actor_wiki1">
          <img alt="image" class="actor" id="actor_img1" />
          <span class="actor-name" id="actor_name1"></span>
        </a>
      </div>
      <div class="img-actor">
        <a class="ang" id="actor_wiki2">
          <img alt="image" class="actor" id="actor_img2" />
          <span class="actor-name" id="actor_name2"></span>
        </a>
      </div>
      <div class="img-actor">
        <a class="ang" id="actor_wiki3">
          <img alt="image" class="actor" id="actor_img3" />
          <span class="actor-name" id="actor_name3"></span>
        </a>
      </div>
      <div class="img-actor">
        <a class="ang" id="actor_wiki4">
          <img alt="image" class="actor" id="actor_img4" />
          <span class="actor-name" id="actor_name4"></span>
        </a>
      </div>
      <div class="sec-list">
        <div class="img-actor">
          <a class="ang" id="actor_wiki5">
            <img alt="image" class="actor" id="actor_img5" />
            <span class="actor-name" id="actor_name5"></span>
          </a>
        </div>
        <div class="img-actor">
          <a class="ang" id="actor_wiki6">
            <img alt="image" class="actor" id="actor_img6" />
            <span class="actor-name" id="actor_name6"></span>
          </a>
        </div>
        <div class="img-actor">
          <a class="ang" id="actor_wiki7">
            <img alt="image" class="actor" id="actor_img7" />
            <span class="actor-name" id="actor_name7"></span>
          </a>
        </div>
      </div>
    </div>
    <div class="watch">
      <h2 class="cast">
        Awards
        <img
          alt="image"
          class="angle"
          src="../assets/images/angle-small-right.png"
        />
      </h2>
      <a class="national" id="award_wiki">
        <h4 id="awardName"></h4>
      </a>
      <a href="../after-login/hollywood.html">
        <button class="btn4">
          <i id="top-arrow" class="fa fa-caret-square-o-up"></i>&nbsp;Back
        </button>
      </a>
      <a id="movie_link">
        <button class="btn3">
          Watch on Prime Video <i id="play" class="fa fa-play-circle-o"></i>
        </button>
      </a>
      <!-- rating -->
      <div class="star_rating">
        <h2 class="rating">Your Rating</h2>
        <button class="star">&#9734;</button>
        <button class="star">&#9734;</button>
        <button class="star">&#9734;</button>
        <button class="star">&#9734;</button>
        <button class="star">&#9734;</button>
        <a href="../after-login/productDetails.html">
          <button class="submit-rate">Submit</button>
        </a>
      </div>
    
      
    </div>
    <!-- HTML code for the comment section -->
    <div class="input-container">
      <input placeholder="Type your comment" id="comment-input" class="input-field" type="text">
      <label for="input-field" class="input-label">Type your comment</label>
      <span class="input-highlight"></span>
    
    </div>
    
     
   
    </div>
    
      
      <div class="comment_con">
       
      </div>
     
      <button class="submit-rate" id="showComment" >Post</button>
    <div class="footer">
      <ol class="social">
        <a class="icons" href="#"><i id="itag" class="fa fa-facebook"></i></a>
        <a class="icons" href="#"><i id="itag" class="fa fa-instagram"></i></a>
        <a class="icons" href="#"><i id="itag" class="fa fa-envelope"></i></a>
        <a class="icons" href="#"><i id="itag" class="fa fa-twitter"></i></a>
        <a class="icons" href="#"><i id="itag" class="fa fa-telegram"></i></a>
      </ol>
      <ol class="quick">
        <h3 class="links">Quick Links</h3>
        <a class="last" href="../index.html">Home</a>
        <a class="last" href="../pages/tamil.html">Kollywood</a>
        <a class="last" href="../pages/holly.html">Hollywood</a>
        <a class="last" href="../pages/super.html">Superhero Movies</a>
        <a class="last" href="../pages/web.html">Web Series</a>
        <a class="last" href="../pages/marvel.html">Marvel Series</a>
      </ol>
      <ol class="policy">
        <a class="last-one" href="#">Help</a>
        <a class="last-one" href="#">Advertising</a>
        <a class="last-one" href="#">Press Room</a>
        <a class="last-one" href="#">Conditions of Use</a>
      </ol>
      <div class="privacy">
        <a class="last-one" href="#">Privacy Policy</a>
        <a class="last-one" href="#">Interest-Based Ads</a>
      </div>
    </div>
  </body>
  <script src="https://momentjs.com/downloads/moment.min.js"></script>
  <script>

    //  URL params

  let c_id = window.location.search;
  let c_params = new URLSearchParams(c_id);
  let get_movie_id = c_params.get("id");
    console.log(get_movie_id);

    const cardarray = JSON.parse(localStorage.getItem("new_card"));

    let movieDetails = cardarray.find(function (event) {
      let id = event["id"];
      if (get_movie_id == id) {
        return true;
      }
    });

    console.log(movieDetails);

    let movieTitle = document.getElementById("movie_title");
    let trailer = document.getElementById("trailer");
    let rateOfTheMovie = document.getElementById("rateOfTheMovie");
    let contentOfMovie = document.getElementById("contentOfMovie");
    let releaseDate = document.getElementById("releaseDate");
    let directorLink = document.getElementById("directorLink");
    let directorName = document.getElementById("directorName");
    let mDirectorLink = document.getElementById("mDirectorLink");
    let mDirectorName = document.getElementById("mDirectorName");
    let actor_wiki1 = document.getElementById("actor_wiki1");
    let actor_img1 = document.getElementById("actor_img1");
    let actor_name1 = document.getElementById("actor_name1");
    let actor_wiki2 = document.getElementById("actor_wiki2");
    let actor_img2 = document.getElementById("actor_img2");
    let actor_name2 = document.getElementById("actor_name2");
    let actor_wiki3 = document.getElementById("actor_wiki3");
    let actor_img3 = document.getElementById("actor_img3");
    let actor_name3 = document.getElementById("actor_name3");
    let actor_wiki4 = document.getElementById("actor_wiki4");
    let actor_img4 = document.getElementById("actor_img4");
    let actor_name4 = document.getElementById("actor_name4");
    let actor_wiki5 = document.getElementById("actor_wiki5");
    let actor_img5 = document.getElementById("actor_img5");
    let actor_name5 = document.getElementById("actor_name5");
    let actor_wiki6 = document.getElementById("actor_wiki6");
    let actor_img6 = document.getElementById("actor_img6");
    let actor_name6 = document.getElementById("actor_name6");
    let actor_wiki7 = document.getElementById("actor_wiki7");
    let actor_img7 = document.getElementById("actor_img7");
    let actor_name7 = document.getElementById("actor_name7");
    let award_wiki = document.getElementById("award_wiki");
    let award_name = document.getElementById("awardName");
    let movie_link = document.getElementById("movie_link");

    movieTitle.innerText = movieDetails["title"];
    trailer.setAttribute("src", movieDetails["link"]);
    directorLink.setAttribute("href", movieDetails["directorLink"]);
    mDirectorLink.setAttribute("href", movieDetails["mDirectorLink"]);
    actor_wiki1.setAttribute("href", movieDetails["actorWiki1"]);
    actor_img1.setAttribute("src", movieDetails["actorImg1"]);
    actor_wiki2.setAttribute("href", movieDetails["actorWiki2"]);
    actor_img2.setAttribute("src", movieDetails["actorImg2"]);
    actor_wiki3.setAttribute("href", movieDetails["actorWiki3"]);
    actor_img3.setAttribute("src", movieDetails["actorImg3"]);
    actor_wiki4.setAttribute("href", movieDetails["actorWiki4"]);
    actor_img4.setAttribute("src", movieDetails["actorImg4"]);
    actor_wiki5.setAttribute("href", movieDetails["actorWiki5"]);
    actor_img5.setAttribute("src", movieDetails["actorImg5"]);
    actor_wiki6.setAttribute("href", movieDetails["actorWiki6"]);
    actor_img6.setAttribute("src", movieDetails["actorImg6"]);
    actor_wiki7.setAttribute("href", movieDetails["actorWiki7"]);
    actor_img7.setAttribute("src", movieDetails["actorImg7"]);
    award_wiki.setAttribute("href", movieDetails["awardWiki"]);
    movie_link.setAttribute("href", movieDetails["movieLink"]);
    rateOfTheMovie.innerText = movieDetails["rate"];
    contentOfMovie.innerText = movieDetails["story"];
    releaseDate.innerText = movieDetails["releaseDate"];
    directorName.innerText = movieDetails["directorName"];
    mDirectorName.innerText = movieDetails["mDirectorName"];
    award_name.innerText = movieDetails["awardName"];
    actor_name1.innerText = movieDetails["actorName1"];
    actor_name2.innerText = movieDetails["actorName2"];
    actor_name3.innerText = movieDetails["actorName3"];
    actor_name4.innerText = movieDetails["actorName4"];
    actor_name5.innerText = movieDetails["actorName5"];
    actor_name6.innerText = movieDetails["actorName6"];
    actor_name7.innerText = movieDetails["actorName7"];



    // comment send
    let commenter;
    let showComment = document.getElementById("showComment");
    showComment.addEventListener("click" , function(event){
      event.preventDefault();
    

      let user_email = JSON.parse(localStorage.getItem("details"));
     
     let user_details = JSON.parse(localStorage.getItem("user"));
     console.log(user_details);
     let get_obj = user_details.find(function(user_obj){
       let check_email = user_obj["email"]
       if(user_email===check_email){   
         return true ;
       }
     });  
     console.log(get_obj);
     let input = document.getElementById("comment-input").value;
     let commenter_name = get_obj["userName"];
     let comment_img = get_obj["image"];

     
     let comment_id = Date.now(); 

   let   commenter ={
  input,
  comment_id,
  user_email,
  get_movie_id,
  commenter_name,
  comment_img,
  current_time: moment().format('DD-MMM-YYYY hh:mm A'),
}
let comments =[];

if (localStorage.getItem("comments") != null) {
  comments = JSON.parse(localStorage.getItem("comments"));
    console.log(comments);
  }

  comments.push(commenter);

  localStorage.setItem("comments", JSON.stringify(comments));

  location.reload();

  });


  // show comments


  
  let set =[];
    let comm = JSON.parse(localStorage.getItem("comments"));
     for(let i = 0 ; i < comm.length ; i++){

      let chech_m = comm[i]["get_movie_id"];
      if(chech_m == get_movie_id){
        set.push(comm[i]);
      }
     }
     console.log(set);

  
   user_email = JSON.parse(localStorage.getItem("details"));

let count = 0 ;

const todayDate = moment()
console.log(todayDate);

let times =  moment("10032023", "DDMMYYYY").fromNow();



for(let i = 0 ; i < set.length ; i++){
  const momentTime = moment(set[i]["current_time"]);
  
  const diffInDays = moment().diff(momentTime, "days");
  let formattedDateTime;
  if (diffInDays > 1) {
    formattedDateTime = momentTime.format("DD-MMM-YYYY h:mm A");
  } else {
    formattedDateTime = momentTime.fromNow();
  }
  count++


let final = document.createElement("div");
final.setAttribute("class" , "comment_fin");



let whole = document.createElement("div");
whole.setAttribute("class" , "comment_div");
final.append(whole);

let span1 = document.createElement("span");
span1.setAttribute("class" ,"times");
span1.innerText = formattedDateTime;
final.append(span1);

let image = document.createElement("img");
image.setAttribute("class", "commenter_img");
image.src = set[i]["comment_img"] ;
whole.append(image);


let name = document.createElement("h2");
name.setAttribute("class" , "commenter_name");
name.innerText = set[i]["commenter_name"];
whole.append(name);


let span = document.createElement("span");
whole.append(span);


let iTag = document.createElement("i");
iTag.setAttribute("id" , "icon");
iTag.setAttribute("onclick" , "likeBtn(this)");
iTag.setAttribute("class" , "fa fa-thumbs-o-up");
span.append(iTag);

if (user_email == set[i]["user_email"]) {
let edit = document.createElement("a");
edit.setAttribute("id" , "comment_edit");
edit.setAttribute("class" , "comments_edit");
edit.setAttribute("onclick" , "edit("+set[i]["comment_id"]+")");
edit.innerText="Edit";
whole.append(edit) 

let dele = document.createElement("a");
dele.setAttribute("id" , "comment_delete");
dele.setAttribute("class" , "comments_delete");
dele.setAttribute("onclick" , "dele("+set[i]["comment_id"]+")");
dele.innerText="Delete";
whole.append(dele) ;


}  

let comments = document.createElement("div");
comments.setAttribute("class" , "comment_one");

final.append(comments)

let div3 = document.createElement("div");
div3.setAttribute("class" ,"comment_input");
div3.setAttribute("id",set[i]["comment_id"]);
final.append(div3);

let input = document.createElement("input");
input.setAttribute("class" ,"new_input");
input.setAttribute("id" ,count);
input.setAttribute("type", "text");
input.value = set[i]["input"];
div3.append(input);

let btn2 = document.createElement("button");
btn2.setAttribute("onclick","input("+count+","+set[i]["comment_id"]+")");
btn2.setAttribute("class","input_btn");
btn2.innerText ="Submit";
div3.append(btn2);



let inpu = document.createElement("span");
inpu.setAttribute("class", "comment_input1");
inpu.innerText = set[i]["input"];
comments.append(inpu);

document.querySelector(".comment_con").prepend(final);

}



// like button



function likeBtn(x) {
   x.classList.toggle("fa-thumbs-up");
}

console.log(rate_count);
 
function edit(x){
   let get_class = document.getElementsByClassName("comment_input");
   for(let i = 0 ; i < get_class.length ; i++){
         get_class[i].style.display = "none";
   }
   let single_input = document.getElementById(x);
   single_input.style.display = "block";

}

function input(x,id) {
  
  let input = document.getElementById(x).value;

  console.log(input);
  let newObj = {input}
  

  let arr = JSON.parse(localStorage.getItem("comments"))
 let up = arr.find(function(e){
  if(id === e["comment_id"]){
    return true 
  }
 })
let update =  Object.assign(up,newObj)
let ind = arr.indexOf(up)
arr[ind] = update 
 localStorage.setItem("comments", JSON.stringify(arr));
 location.reload();
  }

  function dele(id) {

    let arr = JSON.parse(localStorage.getItem("comments"))
    let up = arr.find(function(e){
    if(id === e["comment_id"]){
    return true 
   }
 })
    let ind = arr.indexOf(up)
    arr.splice(ind,1)
    localStorage.setItem("comments", JSON.stringify(arr));
    location.reload();
  }

  </script>
  <script src="../after-login/assets/js/star.js"></script>
  <!-- <script src="../after-login/assets/js/comment.js"></script> -->
</html>
